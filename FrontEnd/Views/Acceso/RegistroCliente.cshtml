@model FrontEnd.Models.RegistroModeloCliente
@{
    ViewData["Title"] = "Registro de Cliente";
    // Layout = "~/Views/Shared/_Layout.cshtml"; // Usualmente definido en _ViewStart.cshtml
}

<div class="jumbotron jumbotron-fluid mb-5">
    <div class="container py-5">
        <div class="row align-items-center">
            <div class="col-lg-6 py-5 py-lg-0">
                <h4 class="text-primary text-uppercase font-weight-bold">Crea tu cuenta</h4>
                <h1 class="text-white mb-4">Regístrate y únete a nosotros</h1>
                <p class="text-white-50 mb-4">Completa los campos para gestionar tus datos y citas.</p>
            </div>
            <div class="col-lg-6">
                <div class="bg-primary py-5 px-4 px-sm-5">
                    <form class="py-5" asp-controller="Acceso" asp-action="RegistroCliente" method="post" id="registrationForm">

                        @Html.AntiForgeryToken()

                        <div asp-validation-summary="ModelOnly" class="alert alert-danger text-white" role="alert"></div>

                        @if (TempData["MensajeRegistroCorrecto"] != null)
                        {
                            <div class="alert alert-success" role="alert">
                                @TempData["MensajeRegistroCorrecto"]
                            </div>
                        }

                        <h5 class="text-white text-uppercase font-weight-bold mt-4">Datos Personales</h5>
                        <div class="form-group">
                            <label asp-for="Nombre" class="text-white"></label>
                            <input asp-for="Nombre" class="form-control border-0 p-4" placeholder="Nombre" />
                            <span asp-validation-for="Nombre" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="PrimerApellido" class="text-white"></label>
                            <input asp-for="PrimerApellido" class="form-control border-0 p-4" placeholder="Primer Apellido" />
                            <span asp-validation-for="PrimerApellido" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="SegundoApellido" class="text-white"></label>
                            <input asp-for="SegundoApellido" class="form-control border-0 p-4" placeholder="Segundo Apellido (Opcional)" />
                            <span asp-validation-for="SegundoApellido" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Cedula" class="text-white"></label>
                            <input asp-for="Cedula" class="form-control border-0 p-4" placeholder="Cédula" />
                            <span asp-validation-for="Cedula" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Correo" class="text-white"></label>
                            <input asp-for="Correo" type="email" class="form-control border-0 p-4" placeholder="Correo Electrónico" />
                            <span asp-validation-for="Correo" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="TelefonoPrincipal" class="text-white"></label>
                            <input asp-for="TelefonoPrincipal" type="tel" class="form-control border-0 p-4" placeholder="Teléfono Principal (Ej: 88888888)" pattern="\d{8}" title="El número de teléfono debe tener 8 dígitos." />
                            <span asp-validation-for="TelefonoPrincipal" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="TelefonoSecundario" class="text-white"></label>
                            <input asp-for="TelefonoSecundario" type="tel" class="form-control border-0 p-4" placeholder="Teléfono Secundario (Opcional)" pattern="\d{8}" title="El número de teléfono debe tener 8 dígitos." />
                            <span asp-validation-for="TelefonoSecundario" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>

                        <h5 class="text-white text-uppercase font-weight-bold mt-4">Dirección</h5>
                        <div class="form-group">
                            <label asp-for="Provincia" class="text-white"></label>
                            <input asp-for="Provincia" class="form-control border-0 p-4" placeholder="Provincia" />
                            <span asp-validation-for="Provincia" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Canton" class="text-white"></label>
                            <input asp-for="Canton" class="form-control border-0 p-4" placeholder="Cantón" />
                            <span asp-validation-for="Canton" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Distrito" class="text-white"></label>
                            <input asp-for="Distrito" class="form-control border-0 p-4" placeholder="Distrito" />
                            <span asp-validation-for="Distrito" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="CodigoPostal" class="text-white"></label>
                            <input asp-for="CodigoPostal" class="form-control border-0 p-4" placeholder="Código Postal (Opcional)" />
                            <span asp-validation-for="CodigoPostal" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="Direccion" class="text-white"></label>
                            <textarea asp-for="Direccion" class="form-control border-0 p-4" placeholder="Dirección Exacta / Señas (Opcional)" rows="3"></textarea>
                            <span asp-validation-for="Direccion" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>

                        <h5 class="text-white text-uppercase font-weight-bold mt-4">Contraseña</h5>
                        <div class="form-group">
                            <label asp-for="Contrasena" class="text-white"></label>
                            <input asp-for="Contrasena" type="password" class="form-control border-0 p-4" id="Contrasena" placeholder="Contraseña" />
                            <div class="bg-light p-3 mt-2" id="passwordHelp" style="display: none; border-radius: 5px;">
                                <p class="mb-1">La contraseña debe cumplir con:</p>
                                <ul class="mb-0">
                                    <li id="length" class="text-danger">Mínimo 6 caracteres (según modelo)</li>
                                    <li id="uppercase" class="text-danger">Una letra mayúscula</li>
                                    <li id="lowercase" class="text-danger">Una letra minúscula</li>
                                    <li id="number" class="text-danger">Un número</li>
                                    <li id="special" class="text-danger">Un carácter especial (#$%^&+=!)</li>
                                </ul>
                            </div>
                            <span asp-validation-for="Contrasena" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>
                        <div class="form-group">
                            <label asp-for="ConfirmarContrasena" class="text-white"></label>
                            <input asp-for="ConfirmarContrasena" type="password" class="form-control border-0 p-4" id="confirm-Contrasena" placeholder="Confirmar Contraseña" />
                            <div id="passwordMismatch" class="alert alert-danger mt-2" style="display: none;">
                                <strong>Las contraseñas no coinciden.</strong>
                            </div>
                            <span asp-validation-for="ConfirmarContrasena" class="text-danger bg-light mt-1 d-block p-1 rounded"></span>
                        </div>

                        <div>
                            <button class="btn btn-dark btn-block border-0 py-3" type="submit">Registrarse</button>
                        </div>
                        <div class="text-center mt-3">
                            <p class="text-white">¿Ya tienes una cuenta? <a asp-controller="Acceso" asp-action="LoginCliente" class="text-dark font-weight-bold">Inicia Sesión</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        // Tu script JS para validación de complejidad y coincidencia puede seguir aquí.
        // Es bueno como feedback instantáneo, pero la validación final es la del servidor.

        // Script para complejidad (ajusta las reglas si son diferentes a las del modelo)
         document.getElementById("Contrasena").addEventListener("input", function () {
            const password = this.value;
            const length = document.getElementById("length");
            const uppercase = document.getElementById("uppercase");
            const lowercase = document.getElementById("lowercase");
            const number = document.getElementById("number");
            const special = document.getElementById("special");
            const passwordHelp = document.getElementById("passwordHelp");

            passwordHelp.style.display = "block";

            // Validaciones (¡Asegúrate que coincidan con las reglas del modelo y/o servidor!)
            // Modelo dice MinLength = 6
            length.classList.toggle("text-success", password.length >= 6);
            length.classList.toggle("text-danger", password.length < 6);

            uppercase.classList.toggle("text-success", /[A-Z]/.test(password));
            uppercase.classList.toggle("text-danger", !/[A-Z]/.test(password));

            lowercase.classList.toggle("text-success", /[a-z]/.test(password));
            lowercase.classList.toggle("text-danger", !/[a-z]/.test(password));

            number.classList.toggle("text-success", /\d/.test(password));
            number.classList.toggle("text-danger", !/\d/.test(password));

            special.classList.toggle("text-success", /[#$%^&+=!]/.test(password));
            special.classList.toggle("text-danger", !/[#$%^&+=!]/.test(password));
        });

        // Script para coincidencia
        const passwordInput = document.getElementById('Contrasena');
        const confirmPasswordInput = document.getElementById('confirm-Contrasena');
        const passwordMismatch = document.getElementById('passwordMismatch');

        function validarContraseña() {
            if (passwordInput.value && confirmPasswordInput.value && passwordInput.value !== confirmPasswordInput.value) {
                 passwordMismatch.style.display = "block";
             } else {
                 passwordMismatch.style.display = "none";
             }
             // La validación del [Compare] se mostrará en el span asp-validation-for="ConfirmarContrasena"
        }

        passwordInput.addEventListener('input', validarContraseña);
        confirmPasswordInput.addEventListener('input', validarContraseña);
    </script>
}